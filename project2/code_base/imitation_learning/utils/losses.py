import numpy as np
import json
from easydict import EasyDict as edict
import yaml
from pathlib import Path
import os
import argparse
import random
from tqdm.notebook import tqdm
import torch
from torch import nn
import torch.nn.functional as F
from torch.utils.data import Dataset, DataLoader
import torch.optim as optim
from torch.optim import lr_scheduler
from sklearn.model_selection import train_test_split

step_weight = np.array([1.65561897, 1.85288284, 1.67791479, 1.84727945, 1.68385422,
                        1.68257972, 1.66273799, 1.68981467, 1.68045769, 1.69024122,
                        1.63114738, 1.5868846, 1.57213433, 1.55555686, 1.55673514,
                        1.54070886, 1.51602138, 1.46375727, 1.44941965, 1.39874536,
                        1.41186884, 1.36078903, 1.36388364, 1.30232109, 1.29969415,
                        1.24510762, 1.22670378, 1.17755808, 1.13782355, 1.10527254,
                        1.20796204, 1.13295195, 1.38539415, 1.50382637, 1.3302265,
                        1.23727591, 1.37529088, 1.49172947, 1.50572536, 1.6439599,
                        1.10415724, 1.19522461, 0.82224739, 1.30330756, 0.91373633,
                        1.21438157, 0.95983261, 1.03246127, 0.91882412, 1.02183228,
                        0.88446524, 0.98188518, 0.84646312, 0.87425586, 0.8007429,
                        0.8025639, 0.77960404, 0.76905068, 0.73991888, 0.71657757,
                        0.7075914, 0.68423292, 0.68371503, 0.64989446, 0.65384312,
                        0.62087306, 0.63867441, 0.60616317, 0.61293234, 0.60555151,
                        0.78394496, 0.77960404, 1.06125958, 1.2316676, 1.03376502,
                        0.92767894, 1.09306601, 1.25014591, 1.24290976, 1.33257877,
                        0.64891103, 0.71153135, 0.46988291, 0.68526988, 0.47862064,
                        0.73359651, 0.54643492, 0.62923421, 0.55927174, 0.59031,
                        0.53727218, 0.61774686, 0.53402751, 0.57661521, 0.51639859,
                        0.5374078, 0.51992968, 0.52679847, 0.5094082, 0.52547054,
                        0.48862954, 0.50569323, 0.48165022, 0.49897367, 0.48469897,
                        0.49346306, 0.5114695, 0.48262372, 0.52137519, 0.51211537,
                        0.66348504, 0.73619327, 1.08372611, 1.26092008, 1.04109655,
                        0.93520178, 1.14358167, 1.29282364, 1.28631406, 1.34916152,
                        0.55969537, 0.64613271, 0.42529704, 0.56252779, 0.45517496,
                        0.59464658, 0.48875289, 0.5561749, 0.50416394, 0.52826307,
                        0.51018021, 0.56809231, 0.51509688, 0.5587074, 0.53727218,
                        0.54519508, 0.55828452, 0.54464494, 0.56666028, 0.56040214,
                        0.57039107, 0.55758042, 0.57778066, 0.56451901, 0.58822781,
                        0.58822781, 0.61046212, 0.60815533, 0.63337698, 0.64841987,
                        0.79751578, 0.81481013, 1.19945542, 1.35907284, 1.17845004,
                        1.06072401, 1.25678962, 1.39662875, 1.40157249, 1.43703481,
                        0.69047832, 0.66398761, 0.52335281, 0.6017426, 0.54176581,
                        0.62923421, 0.56082663, 0.61665642, 0.56938422, 0.59539748,
                        0.59554778, 0.622285, 0.57574267, 0.6349776, 0.61525724,
                        0.62102978, 0.62685649, 0.61386124, 0.64109695, 0.63883562,
                        0.64662214, 0.64989446, 0.65055091, 0.66432286, 0.66415521,
                        0.68199155, 0.71441054, 0.69047832, 0.73211676, 0.73693689,
                        0.92767894, 0.9022777, 1.30462401, 1.48684294, 1.27919138,
                        1.16073846, 1.34542099, 1.50117182, 1.47711785, 1.5133453,
                        0.78592609, 0.74704957, 0.59494683, 0.66583362, 0.61946432,
                        0.67684713, 0.63050601, 0.67804401, 0.62859927, 0.66667441,
                        0.65715199, 0.68027241, 0.65764976, 0.70402856, 0.68354248,
                        0.70402856, 0.70260845, 0.70545154, 0.71766356, 0.7269611,
                        0.73619327, 0.74272546, 0.74441451, 0.76151776, 0.75539205,
                        0.77430938, 0.79791846, 0.79269946, 0.83059065, 0.85203609,
                        1.03507043, 1.02260629, 1.3895965, 1.53954271, 1.36802074,
                        1.23727591, 1.42583501, 1.54226511, 1.55870094, 1.55555686,
                        0.87779351, 0.82038173, 0.7061641, 0.72843043, 0.72202397,
                        0.74441451, 0.72494562, 0.74554268, 0.73378169, 0.73693689,
                        0.75768339, 0.76614462, 0.76094137, 0.78216622, 0.78811112,
                        0.79030222, 0.81955391, 0.77548285, 0.83753753, 0.80560809,
                        0.85010284, 0.82996198, 0.87690776, 0.85031743, 0.89343982,
                        0.87801509, 0.93543785, 0.90341707, 0.95379528, 0.97521673,
                        1.16749621, 1.20339745, 1.51755269, 1.63733447, 1.49852195,
                        1.42763551, 1.5333381, 1.62047844, 1.65227939, 1.63816118,
                        0.97570914, 0.89682871, 0.81501581, 0.81728171, 0.78930551,
                        0.85074677, 0.81439893, 0.86481891, 0.83817194, 0.88334977,
                        0.84881645, 0.91535211, 0.87801509, 0.92627516, 0.92184385,
                        0.93851218, 0.95524076, 0.95403604, 0.99510799, 1.01258977,
                        1.02648512, 1.05591597, 1.04874474, 1.07175754, 1.09389397,
                        1.12100546, 1.14820914, 1.1622042, 1.19161007, 1.21468811,
                        1.39381159, 1.47972987, 1.63568229, 1.70911655, 1.63032421,
                        1.59049338, 1.64520514, 1.69194851, 1.73213281, 1.74529799,
                        1.13724933, 1.10834541, 1.08536851, 1.06528503, 1.05033413,
                        1.13266603, 1.11507954, 1.17934268, 1.16279101, 1.2245384,
                        1.1997582, 1.29772743, 1.27693335, 1.33325161, 1.33459831,
                        1.37355639, 1.37633262, 1.3839962, 1.42835634, 1.46560566,
                        1.44941965, 1.49248267, 1.48872048, 1.53217752, 1.53449956,
                        1.5598816, 1.55359503, 1.59049338, 1.58848749, 1.62662505,
                        1.64437487, 1.73125867, 1.77506265, 1.79805912, 1.76969459,
                        1.77506265, 1.77551072, 1.8007841, 1.81859741, 1.83057074])
